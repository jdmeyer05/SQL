//SQL QUERY FOR ACCRUED NET VOL DATA FROM ACCRUAL TRANSACTIONS TABLE//
SELECT

RAT.RC_NAME,
RAT.RC_USER_KEY,
REPLACE(REPLACE(REPLACE(RAT.PRODUCT, 'C', 'O'), 'DRSA', 'O'), 'GSAR', 'G') as PRODUCT,
REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(RAT.PRODUCT, 'O', 'OSA'), 'C', 'OSA'), 'DRSA', 'ODRSA'), 'G', 'GSA'), 'N', 'NSA'), 'GSASAR', 'GSAR') as DIST,
RCD.WELL_OPERATED_STATUS_FLAG,
SUM(RAT.COMPONENT_AMT) * -1 as Net_Vols

FROM

APPSV.RC_DETAILS RCD,
EULAPPS.P2_REV_ACCRUAL_TRANSACTIONS_V RAT
 
WHERE

(RAT.RC_UID = RCD.RC_UID)
AND (RAT.ACTIVITY_DATE IN (TO_DATE('
2022-09-30
', 'YYYY-MM-DD')))
AND (RAT.ACCOUNTING_DATE IN (TO_DATE('
2022-09-30
', 'YYYY-MM-DD')))
AND (RAT.TRN_COMPONENT_CATEGORY = 'V' ) 


GROUP BY

RAT.PRODUCT,
RAT.RC_NAME,
RAT.RC_USER_KEY,
RCD.WELL_OPERATED_STATUS_FLAG

HAVING

(( SUM(RAT.COMPONENT_AMT) ) > 0.0001) 

ORDER BY 

RAT.RC_NAME,
RAT.PRODUCT































































































































































































































































































































