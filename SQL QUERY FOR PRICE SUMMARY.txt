//SQL QUERY FOR PRICE SUMMARY//
SELECT

DECODE(RAT.TRN_COMPONENT_CATEGORY,'V','VOL','G','GROSS','T','TAX','D','DEDUCT','N','NET') AS COMPONENT_CATEGORY,
RAT.ACCOUNTING_DATE,
RAT.ACTIVITY_DATE,
RAT.AGREEMENT_ID,
RAT.AGR_DET_SEQUENCE,
RAT.INTEREST_TYPE,
REPLACE(REPLACE(REPLACE(RAT.PRODUCT, 'C', 'O'), 'DRSA', 'O'), 'GSAR', 'G') as PRODUCT,
REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(RAT.PRODUCT, 'O', 'OSA'), 'C', 'OSA'), 'DRSA', 'ODRSA'), 'G', 'GSA'), 'N', 'NSA'), 'GSASAR', 'GSAR') as DIST,
RAT.RC_NAME,
RAT.RC_USER_KEY,
RAT.REVERSAL_FLAG,
RAT.TRANSACTION_COMPONENT,
RCD.DIST_RC_NAME,
RCD.SFLD_RC_NAME,
RCD.WELL_OPERATED_STATUS_FLAG AS OPERATED,
RCD.ACQUISITION,
RAT.PRODUCT_CATEGORY AS PRODUCT,
SUM(RAT.DOI_INTEREST),
SUM(RAT.COMPONENT_8_8_AMT),
SUM(RAT.ADJUSTED_8_8_VOLUME),
SUM(RAT.COMPONENT_AMT)

FROM

APPSV.RC_DETAILS RCD,
EULAPPS.P2_REV_ACCRUAL_TRANSACTIONS_V RAT
 
WHERE

(RAT.RC_UID = RCD.RC_UID)
AND (RAT.ACTIVITY_DATE BETWEEN (TO_DATE('
2022-08-31
', 'YYYY-MM-DD')) AND TO_DATE('
2022-09-30
', 'YYYY-MM-DD'))
AND (RAT.ACCOUNTING_DATE BETWEEN (TO_DATE('
2022-08-31
', 'YYYY-MM-DD')) AND TO_DATE('
2022-09-30
', 'YYYY-MM-DD'))
AND ((RAT.TRN_COMPONENT_CATEGORY = 'G' ) OR (RAT.TRN_COMPONENT_CATEGORY = 'V' ))




GROUP BY

DECODE(RAT.TRN_COMPONENT_CATEGORY,'V','VOL','G','GROSS','T','TAX','D','DEDUCT','N','NET'),
RAT.ACCOUNTING_DATE,
RAT.ACTIVITY_DATE,
RAT.AGREEMENT_ID,
RAT.AGR_DET_SEQUENCE,
RAT.INTEREST_TYPE,
RAT.PRODUCT,
RAT.RC_NAME,
RAT.RC_USER_KEY,
RAT.REVERSAL_FLAG,
RAT.TRANSACTION_COMPONENT,
RCD.DIST_RC_NAME,
RCD.SFLD_RC_NAME,
RCD.WELL_OPERATED_STATUS_FLAG,
RCD.ACQUISITION,
RAT.PRODUCT_CATEGORY 

HAVING

 (( SUM(RAT.COMPONENT_AMT) ) > 0.0001) 

ORDER BY 

RAT.ACCOUNTING_DATE,
DECODE(RAT.TRN_COMPONENT_CATEGORY,'V','VOL','G','GROSS','T','TAX','D','DEDUCT','N','NET')






























































































































































































































































































